{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "delete build",
      "type": "shell",
      "command": "rm",
      "args": [
        "-rf",
        "~/llvm-project/build/"
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "label": "Build Offload Test Suite",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-B", "~/llvm-project/build/",
        "-S", "~/llvm-project/llvm",
        "-GNinja",
        "-DCMAKE_BUILD_TYPE=Debug",
        "-DLLVM_ENABLE_PROJECTS='clang'",
        "-DLLVM_TARGETS_TO_BUILD='X86;SPIRV'",
        "-DLLVM_EXPERIMENTAL_TARGETS_TO_BUILD='DirectX'",
        "-DLLVM_INCLUDE_SPIRV_TOOLS_TESTS=ON",
        "-DLLVM_OPTIMIZED_TABLEGEN=1",
        "-DLLVM_ENABLE_LLD=1",
        "-DLLVM_USE_SPLIT_DWARF=1",
        "-DCMAKE_CXX_COMPILER=clang++",
        "-DCMAKE_C_COMPILER=clang",
        "-DCMAKE_EXPORT_COMPILE_COMMANDS=1",
        "-DCMAKE_INSTALL_PREFIX=run",
        "-DLLVM_ENABLE_RUNTIMES=offload",
        "-DOFFLOADTEST_TEST_CLANG=ON",
        "-DLLVM_LIT_ARGS='--xunit-xml-output=testresults.xunit.xml -v'",
        "-DLLVM_EXTERNAL_PROJECTS='OffloadTest'",
        "-DLLVM_EXTERNAL_OFFLOADTEST_SOURCE_DIR=$HOME/llvm-project/../offload-test-suite",
        "-DCLANG_ENABLE_HLSL=ON",
        "-DDXC_DIR=~/DirectXShaderCompiler/build/bin"
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "label": "Run Offload Test Suite - Clang",
      "type": "shell",
      "command": "ninja -C ~/llvm-project/build/ check-hlsl-clang-vk",
      "args": [],
      "group": {
        "kind": "test",
        "isDefault": false
      }
    },
    {
      "label": "Run Offload Test Suite - DXC",
      "type": "shell",
      "command": "ninja -C ~/llvm-project/build/ check-hlsl-vk",
      "args": [],
      "group": {
        "kind": "test",
        "isDefault": false
      }
    }
  ]
}